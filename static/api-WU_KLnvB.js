import{g as A,s as B}from"./index-BxRPn9bu.js";import{E as m}from"./element-aSOru_k-.js";import{l as C,r as _,c as E,ah as s,m as p,M as f,O as o,U as u,p as b,a7 as k,F as g,S as M}from"./vue-Bll-6hFI.js";import{_ as S}from"./index-B1QSJmDc.js";import"./vxe-BvPjuzEQ.js";const h=C({name:"接口配置",__name:"api",setup(w){const e=_({api_url:"",api_key:"",models:"",default_model:"",default_backup:""}),i=_([]),v=_(null),V={api_url:[{required:!0,message:"请填写接口配置",trigger:"blur"}],api_key:[{required:!0,message:"请填写API秘钥",trigger:"blur"}],models:[{required:!0,message:"请填写模型配置",trigger:"blur"}]};E(()=>{A().then(t=>{if(t.data){e.value=t.data;let l=t.data.models.split(",");i.value=l.filter(d=>d!="")}})});function y(){if(!e.value.models)return;let t=e.value.models.split(",");i.value=t.filter(l=>l!=""),t.indexOf(e.value.default_model)==-1&&(e.value.default_model=""),t.indexOf(e.value.default_backup)==-1&&(e.value.default_backup="")}function x(t){e.value,t==null||t.validate((l,d)=>{if(l)B({api_url:e.value.api_url,api_key:e.value.api_key,models:e.value.models,default_model:e.value.default_model,default_backup:e.value.default_backup}).then(r=>{r.code==0?m.success("保存成功"):m.error(r.message)}).catch(r=>{m.error(r)});else for(var n in d){d[n].forEach(r=>{m({message:r.message,type:"error"})});break}})}return(t,l)=>{const d=s("el-input"),n=s("el-form-item"),r=s("el-option"),c=s("el-select"),q=s("el-button"),U=s("el-form");return p(),f(U,{ref_key:"settingForm",ref:v,model:e.value,"label-width":"auto",style:{padding:"35px 20px"},rules:V},{default:o(()=>[u(n,{label:"接口配置",prop:"api_url",required:""},{default:o(()=>[u(d,{modelValue:e.value.api_url,"onUpdate:modelValue":l[0]||(l[0]=a=>e.value.api_url=a),placeholder:"https://api.openai.com"},null,8,["modelValue"])]),_:1}),u(n,{label:"API秘钥",prop:"api_key",required:""},{default:o(()=>[u(d,{modelValue:e.value.api_key,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.api_key=a),placeholder:"sk-******"},null,8,["modelValue"])]),_:1}),u(n,{label:"模型配置",prop:"models",required:""},{default:o(()=>[u(d,{type:"textarea",rows:3,modelValue:e.value.models,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.models=a),onBlur:y,placeholder:"请至少输入1个模型，多个模型用,隔开"},null,8,["modelValue"])]),_:1}),u(n,{label:"默认模型"},{default:o(()=>[u(c,{modelValue:e.value.default_model,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.default_model=a),placeholder:"未选择默认模型将采用配置中的第1个",clearable:""},{default:o(()=>[(p(!0),b(g,null,k(i.value,a=>(p(),f(r,{label:a,value:a},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),u(n,{label:"默认备用模型"},{default:o(()=>[u(c,{modelValue:e.value.default_backup,"onUpdate:modelValue":l[4]||(l[4]=a=>e.value.default_backup=a),placeholder:"未选择默认备用模型将采用配置中的第1个",clearable:""},{default:o(()=>[(p(!0),b(g,null,k(i.value,a=>(p(),f(r,{disabled:e.value.default_model==a,label:a,value:a},null,8,["disabled","label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),u(n,{class:"setting-btns"},{default:o(()=>[u(q,{type:"primary",onClick:l[5]||(l[5]=a=>x(v.value))},{default:o(()=>[M("保存")]),_:1})]),_:1})]),_:1},8,["model"])}}}),L=S(h,[["__scopeId","data-v-2bf97d46"]]);export{L as default};
