import{r as x,_ as Q}from"./index-B1QSJmDc.js";import{k as z,s as W,t as X,E as q}from"./element-aSOru_k-.js";import{u as Y}from"./usePagination-ej6RUfcC.js";import{l as ee,r as g,Z as ae,d as le,ah as r,ap as te,m as d,p as oe,P as B,M as p,O as e,U as a,u as c,S as u,q as O}from"./vue-Bll-6hFI.js";import"./vxe-BvPjuzEQ.js";function ne(m,i){return x({url:`customer/status/${m}`,method:"post",data:{status:i}})}function re(m){return x({url:`customer/${m.id}`,method:"post",data:m})}function se(m){return x({url:"customers",method:"get",params:m})}const ue={class:"app-container"},ie={class:"table-wrapper"},de={class:"pager-wrapper"},ce=ee({name:"ElementPlus",__name:"index",setup(m){const i=g(!1),{paginationData:n,handleCurrentChange:M,handleSizeChange:N}=Y(),D={id:void 0,email:"",password:"",level:"common"},v=g(!1),C=g(null),s=g(z(D)),T={email:[{required:!0,trigger:"blur",message:"请输入注册邮箱"}],password:[{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}],level:[{required:!0,trigger:"blur",message:"请选择用户等级"}]},j=()=>{var t;(t=C.value)==null||t.validate((o,b)=>{if(!o)return console.error("表单校验不通过",b);i.value=!0,re(s.value).then(()=>{q.success("操作成功"),v.value=!1,w()}).finally(()=>{i.value=!1})})},I=()=>{var t;(t=C.value)==null||t.clearValidate(),s.value=z(D)},S=(t,o)=>{ne(t,o).then(()=>{q.success("更改状态成功"),w()})},L=t=>{v.value=!0,s.value=Object.assign(z(t),{password:""})},V=g([]),P=g(null),y=ae({keyword:""}),w=()=>{i.value=!0,se({page:n.currentPage,limit:n.pageSize,keyword:y.keyword||void 0}).then(({data:t})=>{n.total=t.total,V.value=t.data}).catch(()=>{V.value=[]}).finally(()=>{i.value=!1})},U=()=>{n.currentPage===1?w():n.currentPage=1},Z=()=>{var t;(t=P.value)==null||t.resetFields(),U()};return le([()=>n.currentPage,()=>n.pageSize],w,{immediate:!0}),(t,o)=>{const b=r("el-input"),h=r("el-form-item"),_=r("el-button"),A=r("el-form"),F=r("el-card"),f=r("el-table-column"),k=r("el-tag"),G=r("el-table"),H=r("el-pagination"),R=r("el-option"),J=r("el-select"),K=r("el-dialog"),$=te("loading");return d(),oe("div",ue,[B((d(),p(F,{shadow:"never",class:"search-wrapper"},{default:e(()=>[a(A,{ref_key:"searchFormRef",ref:P,inline:!0,model:y},{default:e(()=>[a(h,{prop:"username",label:""},{default:e(()=>[a(b,{modelValue:y.keyword,"onUpdate:modelValue":o[0]||(o[0]=l=>y.keyword=l),placeholder:"输入查询"},null,8,["modelValue"])]),_:1}),a(h,null,{default:e(()=>[a(_,{type:"primary",icon:c(W),onClick:U},{default:e(()=>[u("查询")]),_:1},8,["icon"]),a(_,{icon:c(X),onClick:Z},{default:e(()=>[u("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1})),[[$,i.value]]),B((d(),p(F,{shadow:"never"},{default:e(()=>[O("div",ie,[a(G,{data:V.value},{default:e(()=>[a(f,{prop:"customer_no",label:"用户编号",align:"center"}),a(f,{prop:"email",label:"注册邮箱",align:"center"}),a(f,{prop:"level",label:"用户等级",align:"center"},{default:e(l=>[l.row.level=="vip"?(d(),p(k,{key:0,type:"primary",effect:"plain"},{default:e(()=>[u("会员用户")]),_:1})):(d(),p(k,{key:1,type:"warning",effect:"plain"},{default:e(()=>[u("普通用户")]),_:1}))]),_:1}),a(f,{prop:"status",label:"账户状态",align:"center"},{default:e(l=>[l.row.status=="enabled"?(d(),p(k,{key:0,type:"success",effect:"plain"},{default:e(()=>[u("启用")]),_:1})):(d(),p(k,{key:1,type:"danger",effect:"plain"},{default:e(()=>[u("禁用")]),_:1}))]),_:1}),a(f,{prop:"created_at",label:"注册时间",align:"center"}),a(f,{fixed:"right",label:"操作",width:"150",align:"center"},{default:e(l=>[a(_,{type:"primary",text:"",bg:"",size:"small",onClick:E=>L(l.row)},{default:e(()=>[u("编辑")]),_:2},1032,["onClick"]),l.row.status=="enabled"?(d(),p(_,{key:0,type:"danger",text:"",bg:"",size:"small",onClick:E=>S(l.row.id,"disabled")},{default:e(()=>[u("禁用")]),_:2},1032,["onClick"])):(d(),p(_,{key:1,type:"danger",text:"",bg:"",size:"small",onClick:E=>S(l.row.id,"enabled")},{default:e(()=>[u("启用")]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])]),O("div",de,[a(H,{background:"",layout:c(n).layout,"page-sizes":c(n).pageSizes,total:c(n).total,"page-size":c(n).pageSize,currentPage:c(n).currentPage,onSizeChange:c(N),onCurrentChange:c(M)},null,8,["layout","page-sizes","total","page-size","currentPage","onSizeChange","onCurrentChange"])])]),_:1})),[[$,i.value]]),a(K,{modelValue:v.value,"onUpdate:modelValue":o[5]||(o[5]=l=>v.value=l),title:s.value.id===void 0?"新增用户":"修改用户",onClosed:I,width:"30%"},{footer:e(()=>[a(_,{onClick:o[4]||(o[4]=l=>v.value=!1)},{default:e(()=>[u("取消")]),_:1}),a(_,{type:"primary",onClick:j,loading:i.value},{default:e(()=>[u("确认")]),_:1},8,["loading"])]),default:e(()=>[a(A,{ref_key:"formRef",ref:C,model:s.value,rules:T,"label-width":"100px","label-position":"left"},{default:e(()=>[a(h,{prop:"email",label:"注册邮箱"},{default:e(()=>[a(b,{modelValue:s.value.email,"onUpdate:modelValue":o[1]||(o[1]=l=>s.value.email=l),placeholder:"请输入注册邮箱"},null,8,["modelValue"])]),_:1}),a(h,{prop:"level",label:"用户等级"},{default:e(()=>[a(J,{modelValue:s.value.level,"onUpdate:modelValue":o[2]||(o[2]=l=>s.value.level=l),placeholder:""},{default:e(()=>[a(R,{label:"会员用户",value:"vip"}),a(R,{label:"普通用户",value:"common"})]),_:1},8,["modelValue"])]),_:1}),a(h,{prop:"password",label:"密码"},{default:e(()=>[a(b,{type:"password",modelValue:s.value.password,"onUpdate:modelValue":o[3]||(o[3]=l=>s.value.password=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ve=Q(ce,[["__scopeId","data-v-a5e09125"]]);export{ve as default};
